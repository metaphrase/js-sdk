!function(){var a=function(a){a="undefined"!=typeof a?a:{},["projectId","API_KEY"].forEach(function(b){if(!a.hasOwnProperty(b))throw"Parameter "+b+" is required!"}),this.parameters={projectId:null,language:"en",API_KEY:null,cacheType:null,cacheTTL:36e5,reportMissingKeys:!1},this.API_BASE="https://translate.nohponex.gr/";for(var b in a)a.hasOwnProperty(b)&&this.parameters.hasOwnProperty(b)&&(this.parameters[b]=a[b]);this.language=this.parameters.language,this.missingKeys=[],this.translation=[]};a.prototype.switchLanguage=function(a,b){a&&(this.language=a);var c=this.API_BASE+"fetch/listing/?id="+this.parameters.projectId+"&language="+this.language+"&api_key="+this.parameters.API_KEY,d="undefined"!=typeof sessionStorage?sessionStorage.getItem(c):null;if(d||"undefined"==typeof localStorage||(d=localStorage.getItem(c)),d)try{if(d=JSON.parse(d),!d.date)throw"date not set";var e=new Date-new Date(d.date);e<this.parameters.cacheTTL?this.translation=d.translation:(localStorage.removeItem(c),sessionStorage.removeItem(c),d=null)}catch(f){d=null}var g=this;d?b&&b(null,g):this.fetch(this.language,function(a,c,d){a||b&&b(null,g)})},a.prototype.fetch=function(a,b){var c=this,d=new XMLHttpRequest;d.open("GET",this.API_BASE+"fetch/listing/?id="+this.parameters.projectId+"&language="+a+"&api_key="+this.parameters.API_KEY,!0),d.onload=function(){d.status>=200&&d.status<400&&(c.translation=JSON.parse(d.responseText).translation,b&&b(null,a,c.translation))},d.onerror=function(){b&&b("error")},d.send()},a.prototype.metaphrasePage=function(a){a="undefined"!=typeof a?a:document;var b=a.querySelectorAll("[data-i18]");[].forEach.call(b,function(a,b){var c=a.getAttribute("data-i18");if(c){var d=null;if(a.getAttribute("data-i18-data"))try{d=JSON.parse(a.getAttribute("data-i18-data"))}catch(e){d=null}var f=this.metaphraseKeyword(c,d);f?a.innerHTML=f:a.innerHTML||(a.innerHTML=c)}},this),b=a.querySelectorAll("[data-i18-title]"),[].forEach.call(b,function(a,b){var c=a.getAttribute("data-i18-title");if(c){var d=this.metaphraseKeyword(c);d?a.setAttribute("title",d):a.getAttribute("title")||a.setAttribute("title",c)}},this),b=a.querySelectorAll("[data-i18-lang]"),[].forEach.call(b,function(a,b){a.innerHTML=this.language},this),this.parameters.reportMissingKeys&&this.missingKeys.forEach(function(a,b){this.addKey(a)},this)},a.prototype.metaphraseKeyword=function(a,b){b="undefined"!=typeof b?b:null;var c=this.translation[a];if(!c)return this.missingKeys.indexOf(a)<0&&(this.missingKeys.push(a),this.addKey(a)),null;if(b)for(var d in b)b.hasOwnProperty(d)&&(c=c.replace("%"+d+"%",b[d]));return c},a.prototype.addKey=function(a,b,c){var d=new XMLHttpRequest;d.open("POST",this.API_BASE+"fetch/create/?id="+this.parameters.projectId+"&api_key="+this.parameters.API_KEY,!0),d.onload=function(){d.status>=200&&d.status<400&&(console.log("added"),c&&c(null))},d.onerror=function(){c&&c("error")};var e=new FormData;e.append("key",a),d.send(e)},"undefined"==typeof window?(exports.metaphrase=a,"undefined"==typeof XMLHttpRequest&&(XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest)):window.metaphrase=a}();