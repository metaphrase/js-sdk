!function(){var a=function(a){a="undefined"!=typeof a?a:{},["projectId","API_KEY"].forEach(function(b){if(!a.hasOwnProperty(b))throw"Parameter "+b+" is required!"}),this.parameters={projectId:null,language:"en",API_KEY:null,onLoad:null,cacheType:null,cacheTTL:36e5,reportMissingKeys:!1},this.API_BASE="https://translate.nohponex.gr/";for(var b in a)a.hasOwnProperty(b)&&this.parameters.hasOwnProperty(b)&&(this.parameters[b]=a[b]);this.language=this.parameters.language,this.missingKeys=[],this.translation=[],this.switchLanguage(this.language)};a.prototype.switchLanguage=function(a){this.language=a;var b=this.API_BASE+"fetch/listing/?id="+this.parameters.projectId+"&language="+this.language+"&api_key="+this.parameters.API_KEY,c="undefined"!=typeof sessionStorage?sessionStorage.getItem(b):null;if(c||"undefined"==typeof localStorage||(c=localStorage.getItem(b)),c)try{if(c=JSON.parse(c),!c.date)throw"date not set";var d=new Date-new Date(c.date);d<this.parameters.cacheTTL?(this.translation=c.translation,console.log("from cache..")):(localStorage.removeItem(b),sessionStorage.removeItem(b),c=null)}catch(e){c=null}var f=this;c?f.metaphrasePage():this.fetch(this.language,function(a,b,c){a||f.metaphrasePage()})},a.prototype.fetch=function(a,b){var c=this,d=new XMLHttpRequest;d.open("GET",this.API_BASE+"fetch/listing/?id="+this.parameters.projectId+"&language="+a+"&api_key="+this.parameters.API_KEY,!0),d.onload=function(){d.status>=200&&d.status<400&&(c.translation=JSON.parse(d.responseText).translation,b&&b(null,a,c.translation))},d.onerror=function(){b("error")},d.send()},a.prototype.metaphrasePage=function(a){a="undefined"!=typeof a?a:document;var b=a.querySelectorAll("[data-i18]");[].forEach.call(b,function(a,b){var c=a.getAttribute("data-i18");if(c){var d=null;if(a.getAttribute("data-i18-data"))try{d=JSON.parse(a.getAttribute("data-i18-data"))}catch(e){d=null}var f=this.metaphraseKeyword(c,d);f?a.innerHTML=f:a.innerHTML||(a.innerHTML=c)}},this),b=a.querySelectorAll("[data-i18-title]"),[].forEach.call(b,function(a,b){var c=a.getAttribute("data-i18-title");if(c){var d=this.metaphraseKeyword(c);d?a.setAttribute("title",d):a.getAttribute("title")||a.setAttribute("title",c)}},this),b=a.querySelectorAll("[data-i18-lang]"),[].forEach.call(b,function(a,b){a.innerHTML=this.language},this)},a.prototype.metaphraseKeyword=function(a,b){b="undefined"!=typeof b?b:null;var c=this.translation[a];if(!c)return this.missingKeys.indexOf(a)<0&&(this.missingKeys.push(a),this.addKey(a)),null;if(b)for(var d in b)b.hasOwnProperty(d)&&(c=c.replace("%"+d+"%",b[d]));return c},a.prototype.addKey=function(a,b){},"undefined"==typeof window?exports.metaphrase=a:window.metaphrase=a}();